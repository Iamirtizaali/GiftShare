<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Donate Item</title>
  <link rel="icon" href="../Images/Gift Share Logo (2).png" type="image/x-icon">
  <link rel="stylesheet" href="../css/donate-item.css">
  <style>
    .modal {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background-color: white;
      box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
      padding: 20px;
      z-index: 1000;
      text-align: center;
    }

    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      z-index: 999;
    }

    .modal button {
      margin-top: 10px;
      padding: 5px 10px;
      border: none;
      background-color: #007bff;
      color: white;
      cursor: pointer;
    }

    .modal button:hover {
      background-color: #0056b3;
    }

    /* .blur {
      filter: blur(5px);
    } */
  </style>
</head>

<body>
  <div class="dashboard-container">
    <aside class="sidebar">
      <div class="logo">
        <h2>GiftShare</h2>
      </div>
      <nav>
        <ul>
          <li><a href="donor dashboard.html">Dashboard</a></li>
          <li class="active"><a href="#">Donate Item</a></li>
          <li><a href="donor history.html">Donation History</a></li>
          <li><a href="donor account setting.html">Account Settings</a></li>
          <li><a href="#" id="logoutBtn">Log Out</a></li>
        </ul>
      </nav>
    </aside>

    <main class="main-content">
      <header class="page-header">
        <h1>Turn Your Excess into Someoneâ€™s Necessity</h1>
        <p>Donate your items and bring relief to those who need them</p>
      </header>

      <section class="donation-form">
        <h2>Items Details</h2>
        <form id="donationForm">
          <div class="form-group">
            <label for="item-name">Item Name</label>
            <input type="text" id="item-name" placeholder="Enter Item Name" required>
          </div>

          <div class="form-row">
            <div class="form-group">
              <label for="category">Category</label>
              <select id="category" required>
                <option value="Clothing">Clothing</option>
                <option value="Furniture">Furniture</option>
                <option value="Electronics">Electronics</option>
              </select>
            </div>
            <div class="form-group">
              <label for="condition">Condition</label>
              <select id="condition" required>
                <option value="New">New</option>
                <option value="Used">Used</option>
              </select>
            </div>
          </div>

          <div class="form-group">
            <label for="description">Description</label>
            <textarea id="description" rows="3" placeholder="Describe the item"></textarea>
          </div>

          <h2>Photos</h2>
          <div class="form-group">
            <label for="images">Upload Images</label>
            <input type="file" id="images" multiple>
          </div>

          <h2>Pickup/Drop Off Details</h2>
          <div class="form-group">
            <label for="pickup-option">Pickup/Drop-off Option</label>
            <select id="pickup-option" required>
              <option value="Drop-off">Drop-off at designated location</option>
              <option value="Pickup">Pickup from my location</option>
            </select>
          </div>

          <div class="form-group">
            <label for="address">Address (if pickup is chosen)</label>
            <input type="text" id="address" placeholder="Enter your address">
          </div>

          <div class="form-group">
            <label for="pickup-date">Preferred Pickup Date</label>
            <input type="date" id="pickup-date" required>
          </div>

          <button type="submit" class="submit-button">Submit Donation</button>
        </form>
      </section>
    </main>
  </div>

  <div id="modalOverlay" class="modal-overlay" style="display: none;"></div>
  <div id="modalBox" class="modal" style="display: none;">
    <p id="modalMessage"></p>
    <button onclick="closeModal()">OK</button>
  </div>

  <div id="logoutConfirmation" class="confirmation-box" style="display: none;">
    <div class="confirmation-content">
      <p>Are you sure you want to leave?</p>
      <button id="confirmLogout" class="btn-confirm">Yes</button>
      <button id="cancelLogout" class="btn-cancel">No</button>
    </div>
  </div>

  <script>
    function showModal(message) {
      document.getElementById("modalMessage").innerText = message;
      document.getElementById("modalOverlay").style.display = "block";
      document.getElementById("modalBox").style.display = "block";
    }

    function closeModal() {
      document.getElementById("modalOverlay").style.display = "none";
      document.getElementById("modalBox").style.display = "none";
    }

    document.getElementById("donationForm").addEventListener("submit", async (event) => {
      event.preventDefault();

      const formData = {
        itemName: document.getElementById("item-name").value,
        category: document.getElementById("category").value,
        condition: document.getElementById("condition").value,
        description: document.getElementById("description").value,
        images: Array.from(document.getElementById("images").files).map(file => file.name),
        pickupOption: document.getElementById("pickup-option").value,
        address: document.getElementById("address").value,
        pickupDate: document.getElementById("pickup-date").value
      };

      try {
        const response = await fetch("/api/donations", {
          method: "POST",
          headers: {
            "Content-Type": "application/json"
          },
          body: JSON.stringify(formData)
        });

        if (response.ok) {
          showModal("Donation submitted successfully!");
          document.getElementById("donationForm").reset();
        } else {
          showModal("Failed to submit donation. Please try again.");
        }
      } catch (error) {
        console.error("Error submitting donation:", error);
        showModal("An error occurred. Please try again.");
      }
    });

    document.addEventListener("DOMContentLoaded", () => {
      const logoutBtn = document.getElementById("logoutBtn");
      const logoutConfirmation = document.getElementById("logoutConfirmation");
      const confirmLogout = document.getElementById("confirmLogout");
      const cancelLogout = document.getElementById("cancelLogout");

      logoutBtn.addEventListener("click", (e) => {
        e.preventDefault();
        document.body.classList.add("blur");
        logoutConfirmation.style.display = "flex";
      });

      confirmLogout.addEventListener("click", () => {
        document.body.classList.remove("blur");
        window.location.href = "index.html";
      });

      cancelLogout.addEventListener("click", () => {
        document.body.classList.remove("blur");
        logoutConfirmation.style.display = "none";
      });
    });
  </script>
</body>

</html>
